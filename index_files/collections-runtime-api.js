try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="82c065a2-77a4-4b73-8660-a961d562fd28",e._sentryDebugIdIdentifier="sentry-dbid-82c065a2-77a4-4b73-8660-a961d562fd28")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"067b96eb51fc6031ca169b007ce997192563f72c"},(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>W});var n={};e.r(n),e.d(n,{RequestMethod:()=>u,request:()=>f});class o{constructor(){this.resolve=void 0,this.reject=void 0,this.then=void 0,this.catch=void 0,this.promise=void 0,this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise),Object.freeze(this)}}const r=2e3,s=3e4,i=5,a=e=>l(...e.reverse())();function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>n=>t(e(n))))}function c(e,t){return n=>(n[e]=t,n)}let u=function(e){return e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e.PATCH="PATCH",e.HEAD="HEAD",e}({});const d="Something went wrong.",g={"Content-Type":"application/json"};async function f(e){let{url:t,method:n=u.GET,authToken:o,headers:r,toJson:s=!0,throwError:i=!1,useDefaultHeaders:a=!0,queryParams:l,...c}=e;const f={method:n,...o&&{credentials:"include"},headers:{...a&&g,...o&&{Authorization:o},...r},...c};let h;try{if(h=await(null===globalThis||void 0===globalThis?void 0:globalThis.fetch(function(e,t){if(!t)return e;const n=e.indexOf("?")>-1?"&":"?",o=new URLSearchParams(t);return o?"".concat(e).concat(n).concat(o):e}(t,l),{...f})),h.ok&&h.status>=200&&h.status<300){var p;let e;return s&&204!==h.status&&null!==(p=h.headers.get("Content-type"))&&void 0!==p&&p.includes("json")&&(e=await h.json()),{data:e,error:void 0,response:h}}}catch(e){if(i)throw e||new Error(d);return{data:void 0,error:e||d,response:h}}if(i)throw new Error(d);return{data:void 0,error:d,response:h}}function h(e,t){return parseInt(String(p(e,t)),10)}function p(e,t){return m(e,t,globalThis.commonProps)}function v(e,t){return void 0===t&&(t=!1),p("featureFlag.fromCommonProps.enabled",!1)||(globalThis.evaluatedFlags.add(e),globalThis.notifyServerThrottled()),m(e,t,function(){let e;if(window._flags)e=window._flags;else try{e=window.parent._flags}catch(t){e={}}return e}())}function m(e,t,n){void 0===n&&(n=globalThis.commonProps);const o=n||globalThis.commonProps||globalThis.rtCommonProps||{};return void 0===o[e]?t:o[e]}null!==globalThis&&void 0!==globalThis&&globalThis.notifyServerThrottled||(globalThis.notifyServerThrottled=function(e,t,n){let o,{leading:r}=void 0===n?{leading:!1}:n;return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];o&&clearTimeout(o),r&&e(...n),o=setTimeout((()=>{e(...n),o=null}),3e4)}}((async function(){if(function(){let e=!0;return(globalThis.parentFlags||globalThis.commonProps&&!globalThis.rtCommonProps)&&(e=!1),e}())return;const e=Array.from(globalThis.evaluatedFlags);if(globalThis.evaluatedFlags.clear(),e.length)try{await f({url:"/api/uis/flags/notify",method:u.POST,body:JSON.stringify(e),keepalive:!0})}catch(t){console.warn("Couldn't send flags evaluation (flags: ".concat(e,"):"),t)}}),0,{leading:!1})),null!==globalThis&&void 0!==globalThis&&globalThis.evaluatedFlags||(globalThis.evaluatedFlags=new Set);const y={TRACE:"trace",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},w=e=>e===y.WARN?"warning":e===y.TRACE?"log":null==e?void 0:e.toString().toLowerCase(),b=()=>{},T=(e,t)=>t?{[e]:t}:{},S="application/json",E="/_dm/s/rt/actions/logs",R=v("sentry.report.on.client.logs.enabled"),A=v("sentry.report.on.client.logs.levels",["ERROR"]),O=e=>"string"==typeof e?e:["message","msg","text","error","desc","description","dataString"].reduce(((t,n)=>{const o=e[n];return t||("string"==typeof o?o:null)}),null),_=e=>{const t=e=>[y.TRACE,y.DEBUG,y.INFO,y.WARN,y.ERROR].indexOf(e);return n=>o=>{let{level:r,...s}=o;return t(r)>=t(e)&&n({level:r,...s})}},N=function(){const e=[{test:e=>e instanceof Error,format:e=>["message","stack","code","cause"].reduce(((t,n)=>({...T(n,e[n]),...t})),{})},{test:e=>["string","number"].includes(typeof e),format:e=>({message:e})},{test:()=>!0,format:e=>Object.entries(e).reduce(((e,t)=>{let[n,o]=t;return{[n]:["number","string"].includes(typeof o)?o:JSON.stringify(o),...e}}),{})}];return t=>n=>{t({logs:n.map((t=>{let{data:n,level:o,timestamp:r,userAgent:s,url:i,version:a,environment:l}=t;const c=O(n);return{priority:o.toUpperCase(),_error:n._error||n.error,...T("log",c),fields:{_ts:r,_url:i,_userAgent:s,...T("_ver",a),...T("_env",l),...e.find((e=>{let{test:t}=e;return t(n)})).format(n)}}}))})}}();var P;const x=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];try{return e(...n)}catch(e){var r,s;null===(r=console)||void 0===r||null===(s=r.error)||void 0===s||s.call(r,"Exception occurred while processing log message",n)}}}(a([e=>t=>{let{logLevel:n,dataString:o}=t;return e({data:o,level:n})},e=>t=>{var n,o;return e(Object.assign(t,{userAgent:null===(n=window)||void 0===n||null===(n=n.navigator)||void 0===n?void 0:n.userAgent,url:null===(o=window)||void 0===o||null===(o=o.location)||void 0===o?void 0:o.href,timestamp:Date.now()}))},function(e){void 0===e&&(e="");const[t,n]=(e.match(/^(\w+)_([0-9]+)$/)||[]).slice(1);return e=>l(...[t&&c("environment",t),n&&c("version",Number(n)),e].filter(Boolean))}((P=(e,t)=>t&&(t.version||(t.parent!==t?e(e,t.parent):"")))(P,window)),(C=[a([_(y.WARN),e=>t=>{let{data:n,level:o,timestamp:r}=t;return e({level:o,text:"[".concat((s=r,["getHours","getMinutes","getSeconds"].map((e=>new Date(s)[e]().toString().padStart(2,"0"))).join(":")),"] ").concat(O(n)||'Cannot find a description for the message sent. See "fields" for more information.')});var s},()=>e=>{var t,n;let{text:o,level:r}=e;(null!==(t=null===(n=console)||void 0===n?void 0:n[r])&&void 0!==t?t:console.log)(o)}]),a([e=>t=>{var n;return(null!==(n=p("server.for.resources"))&&void 0!==n&&n.includes("localhost")?b:e)(t)},e=>t=>{let{data:n,data:{_skipJournal:o=!1}={},...r}=t;(o?b:e)({data:n,...r})},_(y.TRACE),function(e){let{debounceTime:t=r,timeout:n=s,maxBufferCount:o=i}=void 0===e?{}:e;return function(e){let r,s=null;const i=[],a=function(){s=null,e(i.splice(0))};return e=>{clearInterval(r),i.push(e),s=s||Date.now(),(i.length>=o?a:()=>r=setTimeout(a,Math.max(Math.min(t,s+n-Date.now()))))()}}}({debounceTime:h("common.log.debounceDelay")||500,maxBufferCount:h("common.log.batchLogLimit")||5}),N,e=>t=>{var n;return navigator.sendBeacon?navigator.sendBeacon(E,new Blob([JSON.stringify(t)],{type:S})):null===globalThis||void 0===globalThis||null===(n=globalThis.fetch)||void 0===n||n.call(globalThis,E,{headers:{"content-type":S},credentials:"omit",cache:"no-store",method:"POST",body:JSON.stringify(t)}),e(t)},e=>t=>{var n;if(R&&null!==(n=window)&&void 0!==n&&n.Sentry){const{logs:e}=t;e.length&&e.forEach((e=>{if(A.includes(e.priority)){const{log:t,_error:n,fields:o={}}=e,{_source:r,errorBoundaryId:s,...i}=o;window.Sentry.withScope((o=>{o.setContext("Logger",JSON.parse(JSON.stringify(i))),s&&o.setTag("errorBoundaryId",s),o.setTag("isErrorBoundary","ErrorBoundary"===r),(e=>{let{error:t,logMsg:n,level:o}=e;if(t instanceof Error)window.Sentry.captureException(t);else if("object"==typeof t&&"function"==typeof t.abort&&"function"==typeof t.done){const e=t;let n="jQuery AJAX error";const r={};e.status&&(n+=": ".concat(e.status," ").concat(e.statusText),r.status=e.status,r.statusText=e.statusText),e.responseJSON?(r.responseJSON=e.responseJSON,n+=" - Response: ".concat(JSON.stringify(e.responseJSON))):e.responseText&&(r.responseText=e.responseText.substring(0,200)),window.Sentry.captureMessage(n,w(o))}else"string"==typeof t||n?window.Sentry.captureMessage(null!=t?t:n,w(o)):window.Sentry.captureMessage("An unexpected error type: ".concat(String(t)),w(o))})({error:n,logMsg:t,level:e.priority})}))}}))}return null==e?void 0:e(t)}])],()=>e=>C.forEach((t=>t(e))))]));var C;const[j,D,B,I,J]=[y.TRACE,y.DEBUG,y.INFO,y.WARN,y.ERROR].map((e=>t=>x({logLevel:e,dataString:t}))),F=(Object.assign(x,{[y.TRACE]:j,[y.DEBUG]:D,[y.INFO]:B,[y.WARN]:I,[y.ERROR]:J}),{[y.TRACE]:j,[y.DEBUG]:D,[y.INFO]:B,[y.WARN]:I,[y.ERROR]:J});globalThis._abtests=globalThis._abtests||{};const{request:U}=n;let L=function(e){return e.USER="user",e.STORE="store",e}({});const M=new Map;async function G(e){const{name:t,page:n,filters:r,search:s,sortBy:i,fields:a}=e;return await async function(e,t){let{context:n}=t;if(M.has(e))return console.log("[Collection API] Cache hit for url: ".concat(e,". Returning cached value.")),M.get(e).promise;const r=new o;let s;M.set(e,r);try{var i,a;s=await fetch(e);const t=q(s)?await(null===(i=s)||void 0===i?void 0:i.json()):await(null===(a=s)||void 0===a?void 0:a.text());if(!s.ok)throw new Error((null==t?void 0:t.message)||t);return r.resolve(t),t}catch(e){throw r.resolve(e),async function(e){var t,n;let{error:o,context:r,response:s}=e;const i={context:r,url:null==s?void 0:s.url,status:null==s?void 0:s.status,"d-id":null==s||null===(t=s.headers)||void 0===t||null===(n=t.get)||void 0===n?void 0:n.call(t,"d-request-id")};(function(e,t){const n=null==t?void 0:t.status,o=null==e?void 0:e.message;return 400===n&&o.includes("The requested site does not belong to this domain")||404===n&&o.includes("No collection for site alias")||404===n&&!q(t)||navigator.userAgent.includes("bingbot")})(o,s)||F.error({message:"[Collection API] Error fetching collection data: ".concat(o.message),siteAlias:window.Parameters.SiteAlias,dataString:JSON.stringify(i),error:o,tags:["collections-api"]})}({error:e,context:n,response:s}),e}}(function(e,t,n){const o=e=>"string"==typeof e?e:JSON.stringify(e);n=Object.entries(n).filter((e=>{let[t,n]=e;return n})).flatMap((e=>{let[t,n]=e;return Array.isArray(n)?n.map((e=>[t,o(e)])):[[t,o(n)]]}));const r=new URLSearchParams(n);window.currentLanguage&&r.set("language",window.currentLanguage),["internal-usage#store_catalog#catalog_product","internal-usage#store_catalog#catalog_category"].includes(e)&&(e=e.replaceAll("#","__"));const s=encodeURIComponent(e),i=function(){const e=window.Parameters.isRuntimeServer;return{prefix:e?"rts":"ms",siteFlow:e?"runtime":"designtime",siteAlias:window.Parameters.SiteAlias}}(),a="/".concat(i.prefix,"/collections/public/").concat(i.siteAlias,"/").concat(i.siteFlow,"/collection/").concat(s,"/").concat(t);return r.toString()?"".concat(a,"?").concat(r):a}(t,"data",{page:n,filters:r,search:s,sortBy:i,fields:a}),{context:e})}function k(e){let t,n,o,r,s,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L.USER;return{get:function(){return G({name:e=i===L.STORE?"internal-usage#store_catalog#".concat(e):e,page:r,filters:t,search:n,sortBy:o,fields:s})},pageSize:function(e){return r||(r={}),r.pageSize=e,this},pageNumber:function(e){return r||(r={}),r.pageNumber=e,this},orderBy:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o||(o=[]),o.push({field:e,direction:t}),this},where:function(e,n,o){return t||(t=[]),t.push({field:e,operator:n,value:o}),this},select:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s=t,this},search:function(e){return n=e,this}}}function q(e){const t=e.headers.get("Content-type");return null==t?void 0:t.includes("json")}const W={query:G,data:function(e){return k(e,L.USER)},storeData:function(e){return k(e,L.STORE)}};window["collections-runtime-api"]=t})();
//# sourceMappingURL=collections-runtime-api.js.map